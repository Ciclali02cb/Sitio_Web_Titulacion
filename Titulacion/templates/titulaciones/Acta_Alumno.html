<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        /* Estilos generales */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        
        /* Contenedor del encabezado beige */
        .header-container {
            width: 21.5cm;
            background-color: #f5f5dc;
            padding: 0.5cm 1.5cm;
            margin: 0 auto 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: relative;
        }
        
        /* Contenedor principal (hoja de Word) */
        .page-container {
            width: 21.6cm;
            min-height: 27.9cm;
            margin: 0 auto;
            padding: 2.2cm 2cm 2cm 3.5cm; 
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            position: relative;
            font-size: 10pt;
            box-sizing: border-box; 
        }
         
        /* Estilos para el título */
        .document-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }
        .document {
            font-family: Arial, sans-serif; 
            font-size: 30px;               
            font-weight: 900;              
            color: #333;                 
            margin-bottom: 20px;         
            text-align: center;           
            text-transform: uppercase;     
            letter-spacing: 1.2px;           
        }
        
        .title {
            font-weight: bold;
            text-align: center;
            font-size: 10pt;
            margin-bottom: 20px;
            text-decoration: underline;
        }
        
        /* Estilos para los párrafos */
        .text-justify {
            text-align: justify;
            margin-bottom: 17px;
            font-size: 9.5pt;
            margin-left: 1.9cm;   
            margin-right: 1.3cm;  
            text-indent: 0;
            width: auto;  
            line-height: 1.4;
            margin-top: 0;
            margin-bottom: 0;
            padding: 0;      
        }
       
        .text-center {
            text-align: center;
            font-size: 9.5pt;
        }
        
        /* Estilos para las imágenes */
        .oval-photo {
            position: absolute;
            left: 1.3cm;
            top: 9.5cm;
            width: 3.2cm;
            height: 4.9cm;
            border-radius: 50%;
            border: 1px solid #000;
            object-fit: cover;
        }
        /*.right-image {
            position: absolute;
            right: 2.3cm;
            top: 2cm;
            width: 1.7cm;  
            height: auto;   
            max-height: 2.5cm;
            object-fit: contain;
            background-color: transparent !important;
        }*/
        
        .right-image {
            position: absolute;
            right: 2.3cm;       /* Posición fija desde la derecha */
            top: 2cm;           /* Posición fija desde arriba */
            width: 1.73cm;      /* Ancho deseado */
            height: 3.46cm;     /* Alto deseado */
            object-fit: contain; /* Mantiene proporciones SIN recortar */
            object-position: center; /* Centra la imagen en el espacio */
            background-color: transparent !important;
        }
        /* Estilos para las firmas */
        .signature-section {
            margin-top: 50px;
        }
        
        .president {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .secretary-vocal {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
        }
        .signature-section div > p {
            margin: 0.2em 0;
        }
        .secretary, .vocal {
            text-align: center;
            width: 45%;
        }
        
        .director {
            text-align: center;
            margin-top:30px;
        }
        
        .signature-line {
            width: 7.5cm;
            border-top: 1px solid rgb(0, 0, 0);
            margin: 0 auto;
            padding-top: 0.5px;
        }
        .signature-line2 {
            width: 6cm;
            border-top: 1px solid rgb(0, 0, 0);
            margin: 0 auto;
            padding-top: 0.5px;
        }
        .signature-line3 {
            width: 7cm;
            border-top: 1px solid rgb(0, 0, 0);
            margin: 0 auto;
            padding-top: 0.5px;
        }
        
        /* Estilos para los botones */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
        }
        
        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 13px;
        }
        
        .btn-back {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-back:hover {
            background-color: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .btn-pdf {
            background-color: #dc3545;
            color: white;
        }
        
        .btn-pdf:hover {
            background-color: #c82333;
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .btn-save {
            padding: 8px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
            position: fixed;
            bottom: 20px;
            right: 2%;
            transform: none;
            white-space: nowrap;
        }
        
        .btn-save:hover {
            background: #d47440;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        /* Estilos para el encabezado */
        .institutional-text {
            font-family: Arial;
            font-weight: bold; 
            text-align: center;
            font-size: 11.6pt;
            margin-bottom: 5px;
            margin: right 0.1cm; 
            width: calc(100% - 2cm);
            line-height: 1.0;     
        }
        .institutional-text2 {
            font-weight: bold;
            text-align: center;
            font-size: 12pt;
            margin-bottom: 5px;
            margin-right: 1.3cm;
        }
        
        .document-title {
            font-weight: normal; 
            text-align: center;
            font-size: 11pt;
            margin-bottom: 20px;
            text-decoration: none; 
        }
        
        /* Estilo para los inputs */
        .input-text {
            border: none;
            border-bottom: 1px solid black;
            outline: none;
            background: transparent;
            padding: 0 2px;
        }
        
        .input-day {
            width: 2cm;
            text-align: center;
            border: none;
            border-bottom: 1px solid black;
            font-size: 9.5pt; 
            padding: 0;
            margin: 0 5px;
            outline: none;
        }
        
        .input-month {
            width: 2.3cm;
            text-align: center;
            border: none;
            border-bottom: 1px solid black;
            font-size: 9.5pt; 
            padding: 0;
            margin: 0 5px;
            outline: none;
        }
        
        .input-year {
            width: 2.3cm;
            text-align: center;
            border: none;
            border-bottom: 1px solid black;
            font-size: 9.5pt; 
            padding: 0;
            margin: 0 5px;
            outline: none;
        }
        
        .input-time {
            width: 1.9cm;
            text-align: center;
            border: none;
            border-bottom: 1px solid black;
            font-size: 9.5pt; 
            padding: 0;
            margin: 0 5px;
            outline: none;
        }
        
        .input-number {
            width: 1.2cm;
            text-align: center;
            border: none;
            border-bottom: 1px solid black;
            font-size: 9.5pt; 
            padding: 0;
            margin: 0 5px;
            outline: none;
        }
        
        /* --- Ajustes para líneas pegadas al texto --- */
        .nombre-subrayado, 
        .nombre-subrayado2, 
        .linea-firma, 
        .linea-firma1, 
        .linea-firma2, 
        .linea-firma3 {
            border-bottom: 1px solid black;
            display: inline-block;
            line-height: 0.8;
            vertical-align: baseline;
            margin-bottom: -0.2em;
            box-sizing: border-box;
        }

        .nombre-subrayado {
            width: 400px;
            padding-bottom: 1px;
        }

        .nombre-subrayado2 {
            width: 445px;
            padding-bottom: 1px;
        }

        .linea-firma {
            min-width: 78%;
            padding-bottom: 1px;
        }

        .linea-firma1 {
            min-width: 70%;
            padding-bottom: 1px;
        }

        .linea-firma2 {
            min-width: 100%;
            padding-bottom: 1px;
        }

        .linea-firma3 {
            min-width: 2.8cm;
            text-align: center;
            padding-bottom: 1px;
        }

        .texto-subrayado {
            text-decoration: underline;
        }
        
        .president, 
        .secretary, 
        .vocal, 
        .director {
            margin-right: 0.2cm;
        }

        .president p:first-child,
        .secretary p:first-child,
        .vocal p:first-child,
        .director p:first-child {
            margin-bottom: 0.3cm !important; 
        }

        .form-container {
            margin-top: 0.7cm; 
            padding-top: 0.5cm; 
            position: relative;
            height: auto;      
            min-height: 1.5cm;    
        }

        .data-display {
            display: inline-block;
            min-width: 1.5cm;
            text-align: center;
            padding: 0 2px;
            border-bottom: 1px solid black;
            line-height: 1em;
            font-size: inherit;
            vertical-align: top;
            margin-bottom: -0.2em;
        }
        .cedula-profesional {
            font-family: Arial;
            font-size: 8pt;     
            margin: 0;          
            line-height: 1.2;   
            text-align: center;  
        }
        .oval-figure {
            position: absolute;
            left: 1.3cm;
            top: 9.5cm;
            width: 3.2cm;
            height: 4.9cm;
            border-radius: 50%; 
            border: 1px solid #000;  
            background-color: transparent;  
        }
        @media print {
            .header-container {
                display: none !important;
                visibility: hidden !important;
                height: 0 !important;
                padding: 0 !important;
                margin: 0 !important;
            }
            
            .page-container {
                margin: 0 !important;
                padding: 2.2cm 2cm 2cm 3.5cm !important;
                width: 21.6cm !important;
                min-height: 27.9cm !important;
                box-shadow: none !important;
                position: relative !important;
            }
            
            body {
                padding: 0 !important;
                margin: 0 !important;
                background: white !important;
            }
            
            .action-buttons,
            .btn-save {
                display: none !important;
            }
        }

        @page {
            size: A4;
            margin: 0;
        }
    </style>
</head>
<body>
    <!-- Encabezado con botones -->
    <div class="header-container">     
        <div class="document">ACTA DE TITULACIÓN</div>
          {% load static %}
        
        <div class="action-buttons">
            <form action="{% url 'acta_form' %}" method="POST" style="display: inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-back">Regresar</button>
        </form>
            <button class="btn btn-pdf" onclick="generatePDF()">Generar PDF</button>
        </div>
    </div>
    
    <!-- Contenedor principal (hoja de Word) -->
    <div class="page-container">
        <!-- Óvalo a la izquierda -->
         <div class="oval-figure"></div>
        <!-- Imagen a la derecha -->
        <img src="{% static 'IMG/Logo.png' %}" alt="Imagen derecha" class="right-image">
        
        <div class="header">
            <p class="institutional-text">GOBIERNO DEL ESTADO DE VERACRUZ DE IGNACIO DE LA LLAVE</p>
            <p class="institutional-text2">INSTITUTO TECNOLÓGICO SUPERIOR DE ACAYUCAN</p>
            <p class="document-title">ACTA DE EXAMEN PROFESIONAL</p>
        </div>
        
        <div class="form-container">
            <p class="text-justify">
                En &nbsp; &nbsp;&nbsp;la &nbsp;&nbsp; &nbsp;Ciudad&nbsp;&nbsp;&nbsp;de &nbsp; &nbsp; &nbsp;Acayucan, Ver., a los 
                <span class="data-display">{{ alumno.acta.dia_examen|default:'1' }}</span> días&nbsp; del &nbsp;mes &nbsp;de 
                <span class="data-display">{{ alumno.acta.mes_examen|default:'enero' }}</span> de 
                <span class="data-display">{{ alumno.acta.anio_examen|default:'2025' }}</span>, siendo las 
                <span class="data-display">{{ alumno.acta.hora_inicio|default:'12:00' }}</span> horas, se reunieron 
                en <u>La Sala de Titulación Virtual</u> del Instituto Tecnológico Superior de 
                <u>Acayucan</u>, clave <u>30EIT0010B</u>, los integrantes del Jurado.
            </p>

            <p class="text-justify">Presidente (a): 
                {% if alumno.asesor %}
                <span class="nombre-subrayado">
                    {{ alumno.asesor.sigla }} 
                    {{ alumno.asesor.nombreProfesor }}
                    {{ alumno.asesor.apellidoPaterno }} 
                    {{ alumno.asesor.apellidoMaterno }}
                </span>
                {% else %}
                    -
                {% endif %}
            </p>
            
            <p class="text-justify">Secretario (a): 
                {% if alumno.revisor_1 %}
                <span class="nombre-subrayado">
                    {{ alumno.revisor_1.sigla }} 
                    {{ alumno.revisor_1.nombreProfesor }}
                    {{ alumno.revisor_1.apellidoPaterno }} 
                    {{ alumno.revisor_1.apellidoMaterno }}
                </span>
                {% else %}
                    -
                {% endif %}
            </p>

            <p class="text-justify">Vocal:
                {% if alumno.revisor_2 %}
                <span class="nombre-subrayado2">
                    {{ alumno.revisor_2.sigla }} 
                    {{ alumno.revisor_2.nombreProfesor }}
                    {{ alumno.revisor_2.apellidoPaterno }} 
                    {{ alumno.revisor_2.apellidoMaterno }}
                </span>
                {% else %}
                    -
                {% endif %}
            </p>
            
            <p class="text-justify">
                Y de acuerdo a las disposiciones reglamentarias en vigor sobre la Titulación Integral, se
                procedió&nbsp;&nbsp; a&nbsp; &nbsp;efectuar&nbsp; &nbsp;el &nbsp;&nbsp;Acto&nbsp; &nbsp;de&nbsp; Recepción &nbsp;Profesional&nbsp; &nbsp;a &nbsp;&nbsp;el &nbsp;&nbsp;(la)&nbsp;&nbsp;
            </p>              
            <p class="text-justify"> 
                C. <span class="linea-firma">{{ alumno.nombre }} {{alumno.apellido_paterno}} {{alumno.apellido_materno}}</span>No. de Control
                <span class="linea-firma3">{{ alumno.matricula }}</span>  egresado &nbsp; &nbsp;&nbsp; (a)  &nbsp; &nbsp;&nbsp;del  &nbsp; &nbsp;&nbsp;Instituto &nbsp; &nbsp;&nbsp; Tecnológico &nbsp; &nbsp;&nbsp; Superior  &nbsp; &nbsp;&nbsp;de 
                <u>Acayucan</u>,&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;pasante &nbsp; &nbsp;&nbsp;de&nbsp; &nbsp;&nbsp; la carrera de
                <span class="linea-firma">{{ alumno.carrera }}</span>.
            </p>
            <br>
            <p class="text-justify">
                Tomando en cuenta los integrantes del Jurado, el contenido del Trabajo Profesional,
                cuyo tema es: <span class="linea-firma1">{{ alumno.nombre_del_proyecto }}.</span>
                <span class="linea-firma2"></span><br>
                <span class="linea-firma2"></span>
                y la réplica del mismo, dictaminó que fuera 
                <span class="data-display" style="width: 6.3cm;">{{ alumno.acta.dictamen|default:'Aprobado' }}</span>
            </p>
            <br>
            <p class="text-justify">
                El (la) Presidente (a) del Jurado le hizo saber al sustentante el resultado obtenido,
                el Código de Ética Profesional y le tomó la Protesta de Ley. Dándose por terminado
                el Acto a las <span class="data-display">{{ alumno.acta.hora_fin|default:'13:00' }}</span> horas, se asentó la presente en el libro para Actas de Examen
                Profesional por Titulación Integral No. <span class="data-display">{{ alumno.acta.libro|default:'1' }}</span> a las 
                <span class="data-display">{{ alumno.acta.foja|default:'1' }}</span> fojas, autorizado por la H.
                Junta Directiva del Instituto Tecnológico Superior de <u>Acayucan</u>, fecha 
                <span class="data-display">{{ alumno.acta.dia_examen|default:'1' }}</span> de 
                <span class="data-display">{{ alumno.acta.mes_examen|default:'enero' }}</span> de 
                <span class="data-display">{{ alumno.acta.anio_examen|default:'2025' }}</span>
                y una vez escrita, leída y aprobada la firmaron
                para constancia las personas que en el acto intervinieron.
            </p>
            <br>
            <p class="text-justify">
                Para los usos legales correspondientes, se expide la presente en la Ciudad de
                Acayucan, Veracruz, a los <span class="data-display">{{ alumno.acta.dia_firma|default:'1' }}</span> días del mes de 
                <span class="data-display">{{ alumno.acta.mes_firma|default:'enero' }}</span> del año 
                <span class="data-display">{{ alumno.acta.anio_firma|default:'2025' }}</span>.
            </p>
        </div>
        
        <!-- Sección de firmas -->
        <div class="signature-section">
            <div class="president">
                <p>PRESIDENTE (A)</p>
                <p>
                    {% if alumno.asesor %}
                        {{ alumno.asesor.sigla }} 
                        {{ alumno.asesor.nombreProfesor }}
                        {{ alumno.asesor.apellidoPaterno }} 
                        {{ alumno.asesor.apellidoMaterno }}
                    {% else %}
                        -
                    {% endif %}
                </p>
                <div class="signature-line"></div>
                <p class="cedula-profesional">CÉDULA PROFESIONAL: 
                    {% if alumno.asesor.cedulaProfesor %}
                        {{ alumno.asesor.cedulaProfesor }}
                    {% else %}
                        -
                    {% endif %}
                </p>
            </div>
            
            <div class="secretary-vocal">
                <div class="secretary">
                    <p>SECRETARIO (A)</p>
                    <p>
                        {% if alumno.revisor_1 %}
                            {{ alumno.revisor_1.sigla }} 
                            {{ alumno.revisor_1.nombreProfesor }}
                            {{ alumno.revisor_1.apellidoPaterno }} 
                            {{ alumno.revisor_1.apellidoMaterno }}
                        {% else %}
                            -
                        {% endif %}
                    </p>
                    <div class="signature-line2"></div>
                    <p class="cedula-profesional">CÉDULA PROFESIONAL: 
                        {% if alumno.revisor_1.cedulaProfesor %}
                            {{ alumno.revisor_1.cedulaProfesor }}
                        {% else %}
                            -
                        {% endif %}
                    </p>
                </div>
                
                <div class="vocal">
                    <p>VOCAL</p>
                    <p>
                        {% if alumno.revisor_2 %}
                            {{ alumno.revisor_2.sigla }} 
                            {{ alumno.revisor_2.nombreProfesor }}
                            {{ alumno.revisor_2.apellidoPaterno }} 
                            {{ alumno.revisor_2.apellidoMaterno }}
                        {% else %}
                            -
                        {% endif %}
                    </p>
                    <div class="signature-line3"></div>
                    <p class="cedula-profesional">CÉDULA PROFESIONAL: 
                        {% if alumno.revisor_2.cedulaProfesor %}
                            {{ alumno.revisor_2.cedulaProfesor }}
                        {% else %}
                            -
                        {% endif %}
                    </p>
                </div>
            </div>
            
            <div class="director">
                <p>DIRECTOR (A)</p>
                <p><input type="text" name="nombre_director" id="nombre_director" class="input-text" 
                   value="{{ form.nombre_director.value|default:'DR. Ricardo Ávila García.' }}" 
                   style="width: 200px; text-align: center;"></p>
            </div>
        </div>
    </div>
    
    <script>
        function generatePDF() {
            const matricula = "{{ alumno.matricula }}";
            const element = document.querySelector('.page-container');
            const opt = {
                margin: 0,
                filename: `Acta de ${matricula}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    useCORS: true,
                },
                jsPDF: { unit: 'cm', format: 'a4', orientation: 'portrait' }
            };

            html2pdf()
                .set(opt)
                .from(element)
                .toPdf()
                .get('pdf')
                .then(function(pdf) {
                    const pdfBlob = pdf.output('blob');
                    const pdfUrl = URL.createObjectURL(pdfBlob);
                    const newWindow = window.open(pdfUrl, '_blank');
                    
                    if (!newWindow || newWindow.closed) {
                        const a = document.createElement('a');
                        a.href = pdfUrl;
                        a.download = `Acta de ${matricula}.pdf`;
                        a.click();
                    }
                });
        }
    </script>
</body>
</html>